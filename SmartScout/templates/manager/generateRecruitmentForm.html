
{% extends "index.html" %}

{% block title %}Generate Recruitment Form{% endblock %}

{% block content %}
<div class="overflow-hidden bg-gray-900 h-screen">
    <div class="px-4 py-16 mx-auto sm:max-w-xl md:max-w-full lg:max-w-screen-xl md:px-24 lg:px-8 lg:py-20 h-full">
      <div class="flex flex-col items-center justify-center xl:flex-row h-full">
        <div class="w-full max-w-xl mb-12 xl:pr-16 xl:mb-0 xl:w-7/12">
          <h2 class="max-w-lg mb-6 font-sans text-3xl font-bold tracking-tight text-white sm:text-4xl sm:leading-none">
            Add Job Details
          </h2>
          <p class="max-w-xl mb-4 text-base text-gray-400 md:text-lg">
            Fill out the form below to post a job to the system.
          </p>
        </div>
        <div class="w-full max-w-xl xl:px-8 xl:w-5/12">
          <div class="relative">
            <svg viewBox="0 0 52 24" fill="white" class="absolute bottom-0 right-0 z-0 hidden w-32 -mb-8 -mr-20 text-teal-accent-400 lg:w-32 lg:-mr-16 sm:block">
              <defs>
                <pattern id="766323e1-e594-4ffd-a688-e7275079d540" x="0" y="0" width=".135" height=".30">
                  <circle cx="1" cy="1" r=".7"></circle>
                </pattern>
              </defs>
              <rect fill="url(#766323e1-e594-4ffd-a688-e7275079d540)" width="52" height="24"></rect>
            </svg>
            <div class="bg-zinc-950 text-white relative bg-white rounded shadow-2xl p-7 sm:p-10 h-full">
              <h3 class="mb-4 text-xl font-semibold sm:text-center sm:mb-6 sm:text-2xl">
                Job Details Form
              </h3>

              {% for field in form %}
                {% for error in field.errors %}
                  <p class="text-red-500 text-sm">{{ error }}</p>
                {% endfor %}
              {% endfor %}

              {% if error %}
              <p class="text-red-500 text-sm text-center">{{ error }}</p>
            {% endif %}

              <p class="text-red-500 text-sm text-center">{{ errors }}</p>
              <form method = 'post' class="h-full flex flex-col justify-between" id="jobForm">
                <!-- Job Detail -->
                 {% csrf_token %}


                <input type="hidden" name="skills_required" id="skillsField">


                <div class="mb-4">
                  <label for="jobDetail" class="block text-sm font-medium text-gray-500">Job Detail</label>
                  <textarea id="jobDetail" name="job_details" rows="4" class="w-full mt-2 bg-transparent px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"></textarea>
                </div>
  
                <!-- Skills Required -->
                <div class="mb-4">
                  <label for="skillInput" class="block text-sm font-medium text-gray-500">Skills Required</label>
                  <div class="flex space-x-2 mt-1">
                    <input type="text" id="skillInput" class="flex-grow bg-transparent border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 px-2 py-1" placeholder="Enter a skill">
                    <button type="button" id="addSkill" class="bg-indigo-600 text-white px-4 py-2 rounded-md shadow hover:bg-indigo-500">Add</button>
                  </div>
                  <div id="skillsContainer" class="mt-3 space-y-2"></div>
                </div>
  
                <!-- Expected Salary -->
                <div class="flex gap-2">
                  <div class="mb-4">
                      <label for="expectedSalary" class="block text-sm font-medium text-gray-500">Expected Salary</label>
                      <input type="number" id="expectedSalary" name="expected_salary" class="w-full mt-2 bg-transparent border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
      
                    <!-- Minimum Experience -->
                    <div class="mb-4">
                      <label for="minExperience" class="block text-[12px] font-medium text-gray-500">Minimum Experience</label>
                      <input type="number" id="minExperience" name="minimum_experience" class="w-full mt-2 bg-transparent border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
  
                <!-- Submit Button -->
                <div class="mt-4 mb-2 sm:mb-4">
                  <button type="submit" class="bg-blue-600 inline-flex items-center justify-center w-full h-12 px-6 font-medium tracking-wide text-white transition duration-200 rounded shadow-md hover:bg-deep-purple-accent-700 focus:outline-none">
                    Post Job
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  
    <!-- Card to display result -->
   
  
    <script>
      document.addEventListener('DOMContentLoaded', () => {
          const skillInput = document.getElementById('skillInput');
          const addSkillButton = document.getElementById('addSkill');
          const skillsContainer = document.getElementById('skillsContainer');
          const skillsField = document.getElementById('skillsField'); // Corrected ID
      
          let skills = [];
      
          addSkillButton.addEventListener('click', () => {
              const skill = skillInput.value.trim();
              if (skill && !skills.includes(skill)) {
                  skills.push(skill);
      
                  const skillItem = document.createElement('div');
                  skillItem.className = 'flex items-center space-x-2';
                  skillItem.innerHTML = `
                      <span class="text-sm text-gray-400">${skill}</span>
                      <button type="button" class="text-red-500 hover:text-red-700 remove-skill">Remove</button>
                  `;
      
                  const removeButton = skillItem.querySelector('.remove-skill');
                  removeButton.addEventListener('click', () => {
                      skills = skills.filter(s => s !== skill);
                      skillsContainer.removeChild(skillItem);
                      updateHiddenField();
                  });
      
                  skillsContainer.appendChild(skillItem);
                  skillInput.value = '';
      
                  updateHiddenField();
              } else if (skills.includes(skill)) {
                  alert('Skill already exists!');
              }
          });
      
          function updateHiddenField() {
              skillsField.value = JSON.stringify(skills); 
              console.log("wow " , skillsField.value)
              // Store skills as JSON string
          }
      });
      </script>
      
  </div>
{% endblock %}